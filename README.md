<h1>爬取bilibili的自己账号的收藏夹信息，并且json转excel存储</h1>
	防止自己收藏夹什么视频被删都不知道
	
<h3>源文件下载下来有三点需要注意</h3>

1.UID要改。改成自己的

2.收藏夹要公开

3.路径注意一下。

<h3>功能及其实现思路</h3>

<h4>爬取收藏夹信息</h4>

1.先爬取所有收藏夹的id

2.通过爬取的收藏夹的id，再爬取各个收藏夹的每一页（一页最多20个视频）

3.再稍微整理，得到每个收藏夹的json文件

<h4>爬取视频封面和up主头像</h4>

1.从上一步的json文件中，提取出图片url

2.多线程爬取图片url

<h4>可视化</h4>
写入excel
大概如下图所示，不过上次没失效，而这次失效的视频会在右下角标记出来。

![微信图片_20220412201348](https://user-images.githubusercontent.com/70691271/162960207-bcc4f770-df3d-4c91-8198-340d664fe6e7.png)

## 更新日志(20251130)

#### 主要改进概览

本次更新对B站收藏夹爬虫项目进行了全面的代码优化和功能增强，主要改进包括错误处理、日志记录、代码重构和用户体验等方面。

#### 功能新增

- **超链接支持**: 为Excel中的BV号添加了超链接功能，用户可以直接点击跳转到B站视频页面
- **多用户支持**: 重构主函数结构，支持同时处理多个用户的收藏夹数据
- **图片格式转换**: 新增WebP图片格式自动转换为JPEG功能
- **日志系统**: 引入完整的日志记录系统，支持控制台输出和文件存储

#### 功能优化

- **错误处理机制**: 添加全面的异常处理，包括网络请求重试、JSON格式验证、非法字符过滤
- **网络请求稳定性**: 实现请求重试机制，提高爬虫在不稳定网络环境下的成功率
- **路径处理**: 使用`os.path.join`改进路径拼接，增强跨平台兼容性
- **图片下载**: 重构图片下载逻辑，添加内容类型验证和文件存在性检查

#### Bug修复

- **Excel写入问题**: 修复因特殊字符导致的IllegalCharacterError异常
- **数据完整性**: 添加JSON文件格式验证和数据结构完整性检查
- **颜色定义**: 修正字体颜色定义方式，使用十六进制格式

#### 代码重构

- **模块化设计**: 将图片下载逻辑提取为独立函数，提高代码可维护性
- **函数参数优化**: 重构view函数参数，支持灵活的路径配置
- **主程序结构**: 将原有代码重构为main函数模式，便于扩展和维护

#### 用户体验提升

- **进度提示**: 添加详细的处理进度日志和状态提示
- **程序交互**: 程序运行完成后等待用户按键退出，方便查看结果
- **时间统计**: 完善各阶段用时统计，便于性能分析
- **日志管理**: 自动生成带时间戳的日志文件，支持日志轮转

#### 稳定性提升

- **健壮性增强**: 全面的异常处理确保程序在遇到各种异常情况时不会崩溃
- **数据验证**: 添加对空内容、缺失字段等异常情况的检测和处理
- **资源管理**: 改进文件操作和网络请求的资源管理

#### 致谢:
感谢Deepseek，CodeGeex，Cline等AI工具的大力支持 :=)